!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Jsonic=e()}}((function(){var e={exports:{}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.make=e.exports.util=e.exports.RuleSpec=e.exports.Rule=e.exports.Parser=e.exports.Lexer=e.exports.JsonicError=e.exports.Jsonic=void 0;const t="object",n="string",r="function",s="unexpected",o="map",l="list",i="elem",a="pair",c="val",u="node";class h extends SyntaxError{constructor(e,t,n,r,s){t=_.deep({},t);let o=_.deep({},{rI:s.rI,options:s.options,config:s.config,meta:s.meta,src:()=>s.src(),plugins:()=>s.plugins(),node:s.node,t0:s.t0,t1:s.t1,tI:s.tI,log:s.log,use:s.use}),l=_.make_error_desc(e,t,n,r,o);super(l.message),Object.assign(this,l),_.clean_stack(this)}toJSON(){return{...this,__error:!0,name:this.name,message:this.message,stack:this.stack}}}e.exports.JsonicError=h;class p{constructor(e){this.match={},_.token("@LTP",e),_.token("@LTX",e),_.token("@LCS",e),_.token("@LML",e),this.end={tin:_.token("#ZZ",e),loc:0,len:0,row:0,col:0,val:void 0,src:void 0}}start(e){const t=e.options,n=e.config;let r=e=>_.token(e,n),s=e=>_.token(e,n),o=e.F,l=r("@LTP"),i=r("@LTX"),a=r("@LCS"),c=r("@LML"),u=r("#ZZ"),h=r("#SP"),p=r("#CM"),d=r("#NR"),m=r("#ST"),f=r("#TX"),g=r("#VL");r("#LN");let b={tin:u,loc:0,row:0,col:0,len:0,val:void 0,src:void 0},k=0,v=0,x=0,y=l,w=e.src(),C=w.length,j=null!=e.log?(...t)=>e.log("lex",s(b.tin),o(b.src),k,v+":"+x,s(y),{...b},...t):void 0,S=this;function N(t,n,r,s){return S.bad(e,j,t,b,k,n,v,x,r,r,s)}function I(t){let n=S.match[y];if(null!=n){b.loc=k;for(let r of n){let n=r(k,v,x,w,b,e,t,N);if(n)return k=n.sI?n.sI:k,v=n.rI?n.rI:v,x=n.cI?n.cI:x,y=null==n.state?y:n.state,j&&j(b,r),b}}}let O=function(e){b.len=0,b.val=void 0,b.src=void 0,b.row=v,b.use=void 0;let r=null,s={},o=0,_=[];e:for(;k<C;){let u=w[k];if(l!==y){if(i===y){if(I(e))return b;let r=t.text.hoover?n.charset.hoover_ender:n.charset.text_ender;for(;null!=w[o]&&(!r[w[o]]||n.cmk0.includes(w[o])&&!n.cmk1.includes(w[o+1]));)x++,o++;if(b.len=o-k,b.tin=f,b.val=w.substring(k,o),b.src=b.val,t.text.hoover&&n.multi.SP[b.val[b.val.length-1]]){let e=b.val.length-2;for(;0<e&&n.multi.SP[b.val[e]];)e--;b.val=b.val.substring(0,e+1),b.src=b.val,x-=b.len-e-1,b.len=b.val.length,k+=b.len}else k=o;return y=l,j&&j(b),b}if(a===y){if(I(e))return b;for(o=k;o<C&&!s[w[o]];)o++,x++;return b.val+=w.substring(k,o),b.src=b.val,b.len=b.val.length,k=o,y=l,j&&j(b),b}if(c===y){if(I(e))return b;o=k;let s=1,i=r[0],a=r[1],c=t.balance[r[2]],u=!!r[3],h="",p=i.length,d=a.length;if(u){let e=k-1;for(;-1<e&&n.multi.SP[w[e--]];);let t=k-e-2;0<t&&(h=Object.keys(n.multi.SP)[0].repeat(t))}for(o+=i.length;o<C&&0<s;)a[0]===w[o]&&a===w.substring(o,o+d)?(o+=d,x+=d,s--):c&&i[0]===w[o]&&i===w.substring(o,o+p)?(o+=p,x+=d,s++):(t.char.row===w[o]?(v++,x=0):x++,o++);return b.val=w.substring(k,o),b.src=b.val,b.len=b.val.length,u&&(b.val=b.val.substring(p,b.val.length-d),b.val=b.val.replace(new RegExp(t.char.row+h,"g"),"\n"),b.val=b.val.substring(1,b.val.length-1)),k=o,y=l,j&&j(b),b}return N("invalid_lex_state",k,w[k],{state:y})}{if(I(e))return b;if(n.start.SP[u]){for(b.tin=h,b.loc=k,b.col=x++,o=k+1;n.multi.SP[w[o]];)x++,o++;return b.len=o-k,b.val=w.substring(k,o),b.src=b.val,k=o,j&&j(b),b}if(n.start.LN[u]){for(b.tin=n.lex.core.LN,b.loc=k,b.col=x,o=k,x=0;n.multi.LN[w[o]];)v+=t.char.row===w[o]?1:0,o++;return b.len=o-k,b.val=w.substring(k,o),b.src=b.val,k=o,j&&j(b),b}if(null!=n.singlemap[u])return b.tin=n.singlemap[u],b.loc=k,b.col=x++,b.len=1,b.src=u,k++,j&&j(b),b;if(n.start.NR[u]&&t.number.lex){for(b.tin=d,b.loc=k,b.col=x,o=k;n.charset.digital[w[++o]];);let e=w.substring(k,o);if(null==w[o]||n.charset.value_ender[w[o]]){b.len=o-k;let r=w[k+1];!(1<b.len&&"0"===w[k])||t.number.hex&&"x"===r||t.number.oct&&"o"===r||t.number.bin&&"b"===r?(b.val=+e,null!=n.number.sep_re&&isNaN(b.val)&&(b.val=+e.replace(n.number.sep_re,"")),isNaN(b.val)&&(b.val=void 0,o--)):(b.val=void 0,o--)}if(null!=b.val)return b.src=e,x+=b.len,k=o,j&&j(b),b}if(n.charset.start_blockmarker[u]){let e=w.substring(k,k+n.bmk_maxlen);for(let s of n.bmk)if(e.startsWith(s)){b.tin=m,b.loc=k,b.col=x,y=c,r=[s,t.string.block[s],null,!0];continue e}}if(n.start.ST[u]){b.tin=m,b.loc=k,b.col=x++;let e=n.charset.multiline[u];_=[];let r="";for(o=k+1;o<C;o++)if(x++,u===(r=w[o])){if(!t.string.escapedouble||u!==w[o+1]){o++;break}_.push(w[o]),o++}else if("\\"===r){o++,x++;let e=n.string.escape[w[o]];if(null!=e)_.push(e);else if("x"===w[o]){o++;let e=String.fromCharCode("0x"+w.substring(o,o+2));if(t.char.bad_unicode===e)return k=o-2,N("invalid_ascii",o+2,w.substring(o-2,o+2));_.push(e),o+=1,x+=2}else if("u"===w[o]){o++;let e=String.fromCharCode("0x"+w.substring(o,o+4));if(t.char.bad_unicode===e)return k=o-2,N("invalid_unicode",o+5,w.substring(o-2,o+4));_.push(e),o+=3,x+=4}else _.push(w[o])}else{let s=o,l=u.charCodeAt(0),i="\\".charCodeAt(0),a=w.charCodeAt(o);for(;o<C&&32<=a&&l!==a&&i!==a;)a=w.charCodeAt(++o),x++;if(x--,r=w[o],a<32){if(!e||!n.start.LN[r])return N("unprintable",o,"char-code="+w[o].charCodeAt(0));r===t.char.row&&(v++,x=0),_.push(w.substring(s,o+1))}else _.push(w.substring(s,o)),o--}return u!==r?N("unterminated",o,_.join("")):(b.val=_.join(""),b.src=w.substring(k,o),b.len=o-k,k=o,j&&j(b),b)}if(n.charset.start_commentmarker[u]){let e=w.substring(k,k+n.cmk_maxlen);for(let t of n.cmk)if(e.startsWith(t)){if(!0!==n.comment[t]){b.tin=p,b.loc=k,b.col=x,b.val="",y=c,r=[t,n.comment[t],"comment"];continue e}break}b.tin=p,b.loc=k,b.col=x,b.val="",y=a,s=n.multi.LN;continue e}b.loc=k,b.col=x,o=k;do{x++,o++}while(null!=w[o]&&!n.charset.value_ender[w[o]]);let l=w.substring(k,o),f=t.value[l];if(void 0!==f)return b.tin=g,b.val=f,b.src=l,b.len=o-k,k=o,j&&j(b),b;y=i}}return b.tin=u,b.loc=C,b.col=x,j&&j(b),b};return O.src=w,O}bad(e,t,n,r,s,o,l,i,a,c,u){return r.why=n,r.tin=_.token("#BD",e.config),r.loc=s,r.row=l,r.col=i,r.len=o-s,r.val=a,r.src=c,r.use=u,t&&t(_.token(r.tin,e.config),e.F(r.src),s,l+":"+i,{...r},"error",n),r}lex(e,t){if(null==e)return this.match;let n=this.match[e];return null!=t?(null==n&&(n=this.match[e]=[]),n.push(t)):null===t&&(n=this.match[e],delete this.match[e]),n}clone(e){let t=new p(e);return _.deep(t.match,this.match),t}}var d;e.exports.Lexer=p,function(e){e[e.open=0]="open",e[e.close=1]="close"}(d||(d={}));class m{constructor(e,t,n){this.id=t.rI++,this.name=e.name,this.spec=e,this.node=n,this.state=d.open,this.child=f,this.open=[],this.close=[],this.n={}}process(e){let t=f;return d.open===this.state?t=this.spec.open(this,e):d.close===this.state&&(t=this.spec.close(this,e)),t}}e.exports.Rule=m;let f={id:0,spec:{name:"norule"}};class g{constructor(){this.m=[],this.p="",this.r="",this.b=0,this.n=null,this.h=null}}const b=new g,k=new g;class v{constructor(e){function t(e){return"object"==typeof e&&e.n?(t,n,r)=>{let s=!0;for(let o in e.n)s=s&&(null==n.n[o]||n.n[o]<=e.n[o]);return s}:e}this.name="-",this.def=e,this.def.open=this.def.open||[],this.def.close=this.def.close||[];for(let n of[...this.def.open,...this.def.close])null!=n.c&&(n.c=t(n.c))}open(e,t){let n,r=e,o="",l=t.F;this.def.before_open&&(n=this.def.before_open.call(this,e,t),e.node=n&&n.node||e.node);let i=n&&n.act?{...k,...n.act}:0<this.def.open.length?this.parse_alts(this.def.open,e,t):k;if(i.e)throw new h(s,{open:!0},i.e,e,t);if(e.open=i.m,i.n)for(let s in i.n)e.n[s]=0===i.n[s]?0:(null==e.n[s]?0:e.n[s])+i.n[s],e.n[s]=0<e.n[s]?e.n[s]:0;return i.p?(t.rs.push(e),(r=e.child=new m(t.rsm[i.p],t,e.node)).parent=e,r.n={...e.n},o+="U"):i.r?((r=new m(t.rsm[i.r],t,e.node)).parent=e.parent,r.n={...e.n},o+="R"):o+="Z",this.def.after_open&&this.def.after_open.call(this,e,t,r),t.log&&t.log(u,e.name+"/"+e.id,d[e.state],"w="+o,l(e.node)),e.state=d.close,r}close(e,t){let n,r=f,o="";if(this.def.before_close){if((n=this.def.before_close.call(this,e,t,r))&&n.err)throw new h(n.err,{...n,close:!0},t.t0,e,t);e.node=n&&n.node||e.node}let l=n&&n.act?{...k,...n.act}:0<this.def.close.length?this.parse_alts(this.def.close,e,t):k;if(l.e)throw new h(s,{close:!0},l.e,e,t);if(l.n)for(let s in l.n)e.n[s]=0===l.n[s]?0:(null==e.n[s]?0:e.n[s])+l.n[s],e.n[s]=0<e.n[s]?e.n[s]:0;return l.h&&(r=l.h(this,e,t,r)||r,o+="H"),l.p?(t.rs.push(e),(r=e.child=new m(t.rsm[l.p],t,e.node)).parent=e,r.n={...e.n},o+="U"):l.r?((r=new m(t.rsm[l.r],t,e.node)).parent=e.parent,r.n={...e.n},o+="R"):(r=t.rs.pop()||f,o+="O"),this.def.after_close&&this.def.after_close.call(this,e,t,r),r.why=o,t.log&&t.log(u,e.name+"/"+e.id,d[e.state],"w="+o,t.F(e.node)),r}parse_alts(e,t,n){let r,s=b;s.m=[],s.b=0,s.p="",s.r="",s.n=void 0,s.h=void 0,s.e=void 0;let o,l=0,i=n.config.token;if(i.ZZ!==n.t0.tin){for(s.e=n.t0,l=0;l<e.length;l++){if(o=(o=!(!(o=!(r=e[l]).c||r.c(r,t,n))||null!=r.d)||r.d===n.rs.length)&&(null==r.a||_.marr(r.a,n.rs.slice(-r.a.length).map(e=>e.name).reverse()))){if(null==r.s||0===r.s.length){s.e=void 0;break}if(r.s[0]===n.t0.tin){if(1===r.s.length){s.m=[n.t0],s.e=void 0;break}if(r.s[1]===n.t1.tin){s.m=[n.t0,n.t1],s.e=void 0;break}}else if(i.AA===r.s[0]){s.m=[n.t0],s.e=void 0;break}}r=null}null!=r&&(s.b=r.b?r.b:s.b,s.p=r.p?r.p:s.p,s.r=r.r?r.r:s.r,s.n=r.n?r.n:s.n,s.h=r.h?r.h:s.h)}n.log&&n.log("parse",t.name+"/"+t.id,d[t.state],l<e.length?"alt="+l:"no-alt",l<e.length&&r&&r.s?"["+r.s.map(e=>i[e]).join(" ")+"]":"[]",n.tI,"p="+(s.p||""),"r="+(s.r||""),"b="+(s.b||""),s.m.map(e=>i[e.tin]).join(" "),n.F(s.m.map(e=>e.src)),"c:"+(r&&r.c?o:""),"n:"+Object.entries(t.n).join(";"),s);let a=0,c=s.m.length-(s.b||0);for(;a++<c;)n.next();return s}}e.exports.RuleSpec=v;class x{constructor(e,t){this.rsm={},this.options=e,this.config=t}init(){let e=this.config.token,t=e.OB,n=e.CB,r=e.OS,s=e.CS,u=e.CL,h=e.CA,p=e.TX,d=e.NR,m=e.ST,f=e.VL,g=e.AA,b={val:{open:[{s:[t,h],p:o,n:{im:0}},{s:[t],p:o,n:{im:0}},{s:[r],p:l},{s:[h],d:0,p:l,b:1},{s:[h],b:1},{s:[p,u],p:o,b:2,n:{im:1}},{s:[m,u],p:o,b:2,n:{im:1}},{s:[d,u],p:o,b:2,n:{im:1}},{s:[f,u],p:o,b:2,n:{im:1}},{s:[p]},{s:[d]},{s:[m]},{s:[f]},{s:[n],a:[a],b:1},{s:[s],a:[a],b:1}],close:[{s:[h],d:0,r:i,h:(e,t,n)=>{t.node=[t.node]}},{c:(e,t,n)=>(p===n.t0.tin||d===n.t0.tin||m===n.t0.tin||f===n.t0.tin)&&0===n.rs.length,r:i,h:(e,t,n)=>{t.node=[t.node]}},{s:[g],b:1}],before_close:e=>{e.node=void 0===e.child.node?null==e.open[0]?void 0:e.open[0].val:e.child.node}},map:{before_open:()=>({node:{}}),open:[{s:[n]},{p:a}],close:[]},list:{before_open:()=>({node:[]}),open:[{s:[s]},{p:i}],close:[]},pair:{open:[{s:[m,u],p:c},{s:[p,u],p:c},{s:[d,u],p:c},{s:[f,u],p:c},{s:[n],b:1}],close:[{s:[n]},{s:[h],c:{n:{im:1}},r:a},{s:[h],n:{im:-1},b:1},{s:[m,u],c:{n:{im:1}},r:a,b:2},{s:[p,u],c:{n:{im:1}},r:a,b:2},{s:[d,u],c:{n:{im:1}},r:a,b:2},{s:[f,u],c:{n:{im:1}},r:a,b:2},{s:[m,u],n:{im:-1},b:2},{s:[p,u],n:{im:-1},b:2},{s:[d,u],n:{im:-1},b:2},{s:[f,u],n:{im:-1},b:2},{s:[s],a:[o,c,i],b:1}],before_close:(e,t)=>{let r=e.open[0];if(r&&n!==r.tin){let n=m===r.tin?r.val:r.src,s=e.child.node,o=e.node[n];void 0===s&&u===t.u1.tin&&(s=null),e.node[n]=null==o?s:t.options.object.extend?_.deep(o,s):s}}},elem:{open:[{s:[t],p:o,n:{im:0}},{s:[r],p:l},{s:[h,h],b:2},{s:[h]},{p:c,n:{im:1}}],close:[{s:[h,s]},{s:[h],r:i},{s:[s]},{s:[t],p:o,n:{im:0}},{s:[r],p:l},{s:[p,u],p:o,n:{im:0},b:2},{s:[d,u],p:o,n:{im:0},b:2},{s:[m,u],p:o,n:{im:0},b:2},{s:[f,u],p:o,n:{im:0},b:2},{s:[p],r:i,b:1},{s:[d],r:i,b:1},{s:[m],r:i,b:1},{s:[f],r:i,b:1}],after_open:(e,t,n)=>{e===n&&e.open[0]&&e.node.push(null)},before_close:e=>{void 0!==e.child.node&&e.node.push(e.child.node)}}};this.rsm=Object.keys(b).reduce((e,t)=>(e[t]=new v(b[t]),e[t].name=t,e),{})}rule(e,t){if(null==e)return this.rsm;let n=this.rsm[e];return null===t?delete this.rsm[e]:void 0!==t&&((n=this.rsm[e]=t(this.rsm[e],this.rsm)||this.rsm[e]).name=e),n}start(e,t,n,r,o){let l,i=this.options,a=this.config,c={rI:1,options:i,config:a,meta:r||{},src:()=>t,root:()=>l.node,plugins:()=>n.internal().plugins,node:void 0,u2:e.end,u1:e.end,t0:e.end,t1:e.end,tI:-2,next:k,rs:[],rsm:this.rsm,log:r&&r.log||void 0,F:_.make_src_format(a),use:{}};null!=o&&(c=_.deep(c,o)),_.make_log(c);let u=e=>_.token(e,this.config),p=_.wrap_bad_lex(e.start(c),_.token("#BD",this.config),c),g=new m(this.rsm.val,c);l=g;let b=2*Object.keys(this.rsm).length*p.src.length*2*i.rule.maxmul;function k(){let e;c.u2=c.u1,c.u1=c.t0,c.t0=c.t1;do{e=p(g),c.tI++}while(a.tokenset.IGNORE[e.tin]);return c.t1={...e},c.t0}k(),k();let v=0;for(;f!==g&&v<b;)c.log&&c.log("rule",g.name+"/"+g.id,d[g.state],c.rs.length,c.tI,"["+u(c.t0.tin)+" "+u(c.t1.tin)+"]","["+c.F(c.t0.src)+" "+c.F(c.t1.src)+"]",g,c),g=g.process(c),c.log&&c.log("stack",c.rs.length,c.rs.map(e=>e.name+"/"+e.id).join(";"),g,c),v++;if(_.token("#ZZ",this.config)!==c.t0.tin)throw new h(s,{},c.t0,f,c);return l.node}clone(e,t){let n=new x(e,t);return n.rsm=Object.keys(this.rsm).reduce((e,t)=>(e[t]=_.clone(this.rsm[t]),e),{}),n}}e.exports.Parser=x;let _={token:function(e,t,r){let s=t.token,o=s[e];return null==o&&n===typeof e&&(o=t.tokenI++,s[o]=e,s[e]=o,s[e.substring(1)]=o,null!=r&&Object.assign(r.token,t.token)),o},deep:function(e,...n){let s=r===typeof e,o=null!=e&&(t===typeof e||s);for(let l of n){let n=r===typeof l,i=null!=l&&(t===typeof l||n);if(o&&i&&!n&&Array.isArray(e)===Array.isArray(l))for(let t in l)e[t]=_.deep(e[t],l[t]);else e=void 0===l?e:n?l:i?_.deep(Array.isArray(l)?[]:{},l):l,s=r===typeof e,o=null!=e&&(t===typeof e||s)}return e},clone:function(e){return _.deep(Object.create(Object.getPrototypeOf(e)),e)},charset:(...e)=>e.map(e=>"object"==typeof e?Object.keys(e).join(""):e).join("").split("").reduce((e,t)=>(e[t]=t.charCodeAt(0),e),{}),longest:e=>e.reduce((e,t)=>e<t.length?t.length:e,0),marr:(e,t)=>e.length===t.length&&e.reduce((e,n,r)=>e&&n===t[r],!0),clean_stack(e){e.stack&&(e.stack=e.stack.split("\n").filter(e=>!e.includes("jsonic/jsonic")).map(e=>e.replace(/    at /,"at ")).join("\n"))},make_src_format:e=>(t,n)=>null==t?"":(n=JSON.stringify(t)).substring(0,e.debug.maxlen)+(e.debug.maxlen<n.length?"...":""),make_log:e=>{if("number"==typeof e.log){let n=!1,s=e.log;-1===s&&(s=1,n=!0),e.log=(...o)=>{if(n){let n=o.filter(e=>t!=typeof e).map(e=>r==typeof e?e.name:e).join("\t");e.options.debug.get_console().log(n)}else e.options.debug.get_console().dir(o,{depth:s})}}return e.log},wrap_bad_lex:(e,t,n)=>{let r=r=>{let o=e(r);if(t===o.tin){let e={};throw null!=o.use&&(e.use=o.use),new h(o.why||s,e,o,r,n)}return o};return r.src=e.src,r},errinject:(e,t,n,r,s,o)=>e.replace(/\$([\w_]+)/g,(e,l)=>JSON.stringify("code"===l?t:n[l]||(o.meta?o.meta[l]:void 0)||r[l]||s[l]||o[l]||o.options[l]||o.config[l]||"$"+l)),extract:(e,t,n)=>{let r=0<n.loc?n.loc:0,s=0<n.row?n.row:0,o=0<n.col?n.col:0,l=null==n.src?"":n.src,i=e.substring(Math.max(0,r-333),r).split("\n"),a=e.substring(r,r+333).split("\n"),c=2+(""+(s+2)).length,u=s<2?0:s-2,h=e=>"[34m"+(""+u++).padStart(c," ")+" | [0m"+(null==e?"":e),p=i.length;return[2<p?h(i[p-3]):null,1<p?h(i[p-2]):null,h(i[p-1]+a[0])," ".repeat(c)+"   "+" ".repeat(o)+"[31m"+"^".repeat(l.length||1)+" "+t+"[0m",h(a[1]),h(a[2])].filter(e=>null!=e).join("\n")},wrap_parser:e=>({start:function(t,n,r,s,o){try{return e.start(t,n,r,s,o)}catch(l){if("SyntaxError"===l.name){let e=0,t=0,o=0,i="",a=l.message.match(/^Unexpected token (.) .*position\s+(\d+)/i);if(a){i=a[1],e=parseInt(a[2]),t=n.substring(0,e).replace(/[^\n]/g,"").length;let r=e-1;for(;-1<r&&"\n"!==n.charAt(r);)r--;o=Math.max(n.substring(r,e).length,0)}let c=l.token||{tin:r.token.UK,loc:e,len:i.length,row:l.lineNumber||t,col:l.columnNumber||o,val:void 0,src:i};throw new h(l.code||"json",l.details||{msg:l.message},c,{},l.ctx||{rI:-1,options:r.options,config:{token:{}},token:c,meta:s,src:()=>n,root:()=>{},plugins:()=>r.internal().plugins,node:void 0,u2:c,u1:c,t0:c,t1:c,tI:-1,rs:[],next:()=>c,rsm:{},n:{},log:s?s.log:void 0,F:_.make_src_format(r.internal().config),use:{}})}throw l}}}),make_error_desc(e,t,n,s,o){n={...n};let l=o.options,i=o.meta,a=_.errinject(l.error[e]||l.error.unknown,e,t,n,s,o);r===typeof l.hint&&(l.hint={...l.hint(),...l.hint});let c=["[31m[jsonic/"+e+"]:[0m "+a,"  [34m--\x3e[0m "+(i&&i.fileName||"<no-file>")+":"+n.row+":"+n.col,_.extract(o.src(),a,n),_.errinject((l.hint[e]||l.hint.unknown).replace(/^([^ ])/," $1").split("\n").map((e,t)=>(0===t?" ":"  ")+e).join("\n"),e,t,n,s,o),"  [2mhttps://jsonic.richardrodger.com[0m","  [2m--internal: rule="+s.name+"~"+d[s.state]+"; token="+o.config.token[n.tin]+"; plugins="+o.plugins().map(e=>e.name).join(",")+"--[0m\n"].join("\n"),u={internal:{token:n,ctx:o}};return{...Object.create(u),message:c,code:e,details:t,meta:i,fileName:i?i.fileName:void 0,lineNumber:n.row,columnNumber:n.col}},build_config_from_options:function(e,t){let r=Object.keys(t.token);r.forEach(t=>_.token(t,e));let s=r.filter(e=>null!=t.token[e].c);e.singlemap=s.reduce((n,r)=>(n[t.token[r].c]=e.token[r],n),{});let o=r.filter(e=>n===typeof t.token[e]);e.start=o.reduce((n,r)=>(n[r.substring(1)]=t.token[r].split("").reduce((t,n)=>(t[n]=e.token[r],t),{}),n),{}),e.multi=o.reduce((n,r)=>(n[r.substring(1)]=t.token[r].split("").reduce((t,n)=>(t[n]=e.token[r],t),{}),n),{});let l=r.filter(e=>null!=t.token[e].s);if(e.tokenset=l.reduce((n,r)=>(n[r.substring(1)]=t.token[r].s.split(",").reduce((t,n)=>(t[e.token[n]]=n,t),{}),n),{}),e.charset={},e.string={escape:Object.keys(t.string.escape).reduce((e,n)=>(e[n]=t.string.escape[n],e),{})},e.charset.start_commentmarker={},e.charset.cm_single={},e.cmk=[],e.cmk0="",e.cmk1="",t.comment){e.comment=t.comment;let n=Object.keys(t.comment);n.forEach(t=>{1===t.length?(e.charset.start_commentmarker[t]=t.charCodeAt(0),e.charset.cm_single[t]=t.charCodeAt(0)):(e.charset.start_commentmarker[t[0]]=t.charCodeAt(0),e.cmk.push(t),e.cmk0+=t[0],e.cmk1+=t[1])}),e.cmk_maxlen=_.longest(n)}e.single_char=Object.keys(e.singlemap).join(""),e.charset.digital=_.charset(t.number.digital),e.charset.multiline=_.charset(t.string.multiline),e.charset.value_ender=_.charset(e.multi.SP,e.multi.LN,e.single_char,e.charset.start_commentmarker),e.charset.text_ender=e.charset.value_ender,e.charset.hoover_ender=_.charset(e.multi.LN,e.single_char,e.charset.start_commentmarker),e.charset.start_blockmarker={},e.bmk=[];let i=Object.keys(t.string.block);i.forEach(t=>{e.charset.start_blockmarker[t[0]]=t.charCodeAt(0),e.bmk.push(t)}),e.bmk_maxlen=_.longest(i),e.lex={core:{LN:_.token(t.lex.core.LN,e)}},e.number={sep_re:null!=t.number.sep?new RegExp(t.number.sep,"g"):null},e.debug=t.debug,Object.keys(t.config.modify).forEach(n=>t.config.modify[n](e,t)),t.debug.print_config&&console.log(e)}};function y(e,r){let s,o,l,i,a=_.deep({},r?{...r.options}:{char:{row:"\n",bad_unicode:String.fromCharCode("0x0000")},comment:{"#":!0,"//":!0,"/*":"*/"},balance:{comment:!0},number:{lex:!0,hex:!0,oct:!0,bin:!0,digital:"-1023456789._xoeEaAbBcCdDfF+",sep:"_"},string:{escape:{b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},multiline:"`",block:{"'''":"'''"},escapedouble:!1},text:{hoover:!0,endofline:!1},object:{extend:!0},value:{null:null,true:!0,false:!1},plugin:{},debug:{get_console:()=>console,maxlen:33,print_config:!1},error:{unknown:"unknown error: $code",unexpected:"unexpected character(s): $src",invalid_unicode:"invalid unicode escape: $src",invalid_ascii:"invalid ascii escape: $src",unprintable:"unprintable character: $src",unterminated:"unterminated string: $src"},hint:w,token:{"#OB":{c:"{"},"#CB":{c:"}"},"#OS":{c:"["},"#CS":{c:"]"},"#CL":{c:":"},"#CA":{c:","},"#SP":" \t","#LN":"\n\r","#CM":!0,"#NR":"-0123456789","#ST":"\"'`","#TX":!0,"#VL":!0,"#BD":!0,"#ZZ":!0,"#UK":!0,"#AA":!0,"#IGNORE":{s:"#SP,#LN,#CM"}},lex:{core:{LN:"#LN"}},rule:{maxmul:3},config:{modify:{}},parser:{}},e||{}),c=function(e,t,r){if(n===typeof e){let n=c.internal();return(u.parser.start?_.wrap_parser(u.parser):n.parser).start(n.lexer,e,c,t,r)}return e},u=e=>{if(null!=e&&t===typeof e){_.build_config_from_options(l,_.deep(a,e));for(let e in a)c.options[e]=a[e]}},h={token:function(e){return _.token(e,l,c)},options:_.deep(u,a),parse:c,use:function(e,t){return c.options({plugin:{[e.name]:t||{}}}),c.internal().plugins.push(e),e(c)||c},rule:function(e,t){return c.internal().parser.rule(e,t)},lex:function(e,t){return c.internal().lexer.lex(e,t)},make:function(e){return y(e,c)}};if(Object.defineProperty(h.make,"name",{value:"make"}),Object.assign(h,{internal:()=>({lexer:s,parser:o,config:l,plugins:i})}),r){for(let t in r)c[t]=r[t];c.parent=r;let e=r.internal();l=_.deep({},e.config),_.build_config_from_options(l,a),Object.assign(c.token,l.token),i=[...e.plugins],s=e.lexer.clone(l),o=e.parser.clone(a,l)}else l={tokenI:1,token:{}},_.build_config_from_options(l,a),i=[],s=new p(l),(o=new x(a,l)).init();return Object.assign(c,h),Object.assign(c.token,l.token),c}function w(e=((e,t="replace")=>e[t](/[A-Z]/g,e=>" "+e.toLowerCase())[t](/[~%][a-z]/g,e=>("~"==e[0]?" ":"")+e[1].toUpperCase())),t="~sinceTheErrorIsUnknown,ThisIsProbablyABugInsideJsonic\nitself,OrAPlugin.~pleaseConsiderPostingAGithubIssue -Thanks!|~theCharacter(s) $srcShouldNotOccurAtThisPointAsItIsNot\nvalid %j%s%o%nSyntax,EvenUnderTheRelaxedJsonicRules.~ifItIs\nnotObviouslyWrong,TheActualSyntaxErrorMayBeElsewhere.~try\ncommentingOutLargerAreasAroundThisPointUntilYouGetNoErrors,\nthenRemoveTheCommentsInSmallSectionsUntilYouFindThe\noffendingSyntax.~n%o%t%e:~alsoCheckIfAnyPluginsYouAreUsing\nexpectDifferentSyntaxInThisCase.|~theEscapeSequence $srcDoesNotEncodeAValidUnicodeCodePoint\nnumber.~youMayNeedToValidateYourStringDataManuallyUsingTest\ncodeToSeeHow~javaScriptWillInterpretIt.~alsoConsiderThatYour\ndataMayHaveBecomeCorrupted,OrTheEscapeSequenceHasNotBeen\ngeneratedCorrectly.|~theEscapeSequence $srcDoesNotEncodeAValid~a%s%c%i%iCharacter.~you\nmayNeedToValidateYourStringDataManuallyUsingTestCodeToSee\nhow~javaScriptWillInterpretIt.~alsoConsiderThatYourDataMay\nhaveBecomeCorrupted,OrTheEscapeSequenceHasNotBeenGenerated\ncorrectly.|~stringValuesCannotContainUnprintableCharacters (characterCodes\nbelow 32).~theCharacter $srcIsUnprintable.~youMayNeedToRemove\ntheseCharactersFromYourSourceData.~alsoCheckThatItHasNot\nbecomeCorrupted.|~stringValuesCannotBeMissingTheirFinalQuoteCharacter,Which\nshouldMatchTheirInitialQuoteCharacter.".split("|")){return"unknown|unexpected|invalid_unicode|invalid_ascii|unprintable|unterminated".split("|").reduce((n,r,s)=>(n[r]=e(t[s]),n),{})}e.exports.util=_,e.exports.make=y;let C=y();return e.exports.Jsonic=C,C.use=()=>{throw new Error("Jsonic.use cannot be called directly. Instead write: `Jsonic.make().use(...)`.")},C.Jsonic=C,C.JsonicError=h,C.Lexer=p,C.Parser=x,C.Rule=m,C.RuleSpec=v,C.util=_,C.make=y,e.exports.default=C,e.exports=e.exports.Jsonic,e=e.exports}));