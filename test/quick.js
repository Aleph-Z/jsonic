let { Jsonic } = require('..')

let j = (s)=>{
  try { 
    return JSON.stringify(Jsonic(s))
  }
  catch(e) {
    return e.message.split(/\n/)[0]
  }
}

let cases = [
  ['1',               '1'],
  ['true',            'true'],
  ['x',               '"x"'],
  ['"y"',             '"y"'],

  ['{a:1}',           '{"a":1}'],
  ['{a:1,b:2}',       '{"a":1,"b":2}'],
  ['{a:1,b:2,c:3}',   '{"a":1,"b":2,"c":3}'],
  ['{a:{b:2}}',       '{"a":{"b":2}}'],
  ['{a:{b:2},c:3}',   '{"a":{"b":2},"c":3}'],
  ['{a:{b:2,c:3}}',   '{"a":{"b":2,"c":3}}'],
  ['{a:{b:{c:3}}',    '{"a":{"b":{"c":3}}}'],

  ['a:1',           '{"a":1}'],
  ['a:1,b:2',       '{"a":1,"b":2}'],
  ['a:1,b:2,c:3',   '{"a":1,"b":2,"c":3}'],
  ['a:{b:2}',       '{"a":{"b":2}}'],
  ['a:{b:2},c:3',   '{"a":{"b":2},"c":3}'],
  ['a:{b:2,c:3}',   '{"a":{"b":2,"c":3}}'],
  ['a:{b:{c:3}',    '{"a":{"b":{"c":3}}}'],

  
  ['{a:1,x:0}',             '{"a":1,"x":0}'],
  ['{a:1,b:2,x:0}',         '{"a":1,"b":2,"x":0}'],
  ['{a:{b:2,x:0},x:0}',     '{"a":{"b":2,"x":0},"x":0}'],
  ['{a:{b:2,x:0},c:3,x:0}', '{"a":{"b":2,"x":0},"c":3,"x":0}'],
  ['{a:{b:2,c:3,x:0},x:0}', '{"a":{"b":2,"c":3,"x":0},"x":0}'],
  ['{a:{b:{c:3,x:0},x:0}',  '{"a":{"b":{"c":3,"x":0},"x":0}}'],

  ['a:1,x:0',             '{"a":1,"x":0}'],
  ['a:1,b:2,x:0',         '{"a":1,"b":2,"x":0}'],
  ['a:{b:2,x:0},x:0',     '{"a":{"b":2,"x":0},"x":0}'],
  ['a:{b:2,x:0},c:3,x:0', '{"a":{"b":2,"x":0},"c":3,"x":0}'],
  ['a:{b:2,c:3,x:0},x:0', '{"a":{"b":2,"c":3,"x":0},"x":0}'],
  ['a:{b:{c:3,x:0},x:0',  '{"a":{"b":{"c":3,"x":0},"x":0}}'],


  
  ['{a:b:2}',            '{"a":{"b":2}}'],
  ['{a:b:c:3}',          '{"a":{"b":{"c":3}}}'],
  ['{a:b:2,c:3}',        '{"a":{"b":2},"c":3}'],
  ['{a:1,b:c:3}',        '{"a":1,"b":{"c":3}}'],
  ['{a:b:c:3,d:4}',      '{"a":{"b":{"c":3}},"d":4}'],
  ['{a:1,b:c:d:4}',      '{"a":1,"b":{"c":{"d":4}}}'],
  ['{a:b:2,c:d:4}',      '{"a":{"b":2},"c":{"d":4}}'],
  ['{a:b:c:3,d:e:f:6}',  '{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}'],

  ['a:b:2',            '{"a":{"b":2}}'],
  ['a:b:c:3',          '{"a":{"b":{"c":3}}}'],
  ['a:b:2,c:3',        '{"a":{"b":2},"c":3}'],
  ['a:1,b:c:3',        '{"a":1,"b":{"c":3}}'],
  ['a:b:c:3,d:4',      '{"a":{"b":{"c":3}},"d":4}'],
  ['a:1,b:c:d:4',      '{"a":1,"b":{"c":{"d":4}}}'],
  ['a:b:2,c:d:4',      '{"a":{"b":2},"c":{"d":4}}'],
  ['a:b:c:3,d:e:f:6',  '{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}'],

  
  ['{x:{a:b:2}}',            '{"x":{"a":{"b":2}}}'],
  ['{x:{a:b:c:3}}',          '{"x":{"a":{"b":{"c":3}}}}'],
  ['{x:{a:b:2,c:3}}',        '{"x":{"a":{"b":2},"c":3}}'],
  ['{x:{a:1,b:c:3}}',        '{"x":{"a":1,"b":{"c":3}}}'],
  ['{x:{a:b:c:3,d:4}}',      '{"x":{"a":{"b":{"c":3}},"d":4}}'],
  ['{x:{a:1,b:c:d:4}}',      '{"x":{"a":1,"b":{"c":{"d":4}}}}'],
  ['{x:{a:b:2,c:d:4}}',      '{"x":{"a":{"b":2},"c":{"d":4}}}'],
  ['{x:{a:b:c:3,d:e:f:6}}',  '{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}}'],

  ['x:{a:b:2}',            '{"x":{"a":{"b":2}}}'],
  ['x:{a:b:c:3}',          '{"x":{"a":{"b":{"c":3}}}}'],
  ['x:{a:b:2,c:3}',        '{"x":{"a":{"b":2},"c":3}}'],
  ['x:{a:1,b:c:3}',        '{"x":{"a":1,"b":{"c":3}}}'],
  ['x:{a:b:c:3,d:4}',      '{"x":{"a":{"b":{"c":3}},"d":4}}'],
  ['x:{a:1,b:c:d:4}',      '{"x":{"a":1,"b":{"c":{"d":4}}}}'],
  ['x:{a:b:2,c:d:4}',      '{"x":{"a":{"b":2},"c":{"d":4}}}'],
  ['x:{a:b:c:3,d:e:f:6}',  '{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}}'],

  
  ['{y:{x:{a:b:2}}}',            '{"y":{"x":{"a":{"b":2}}}}'],
  ['{y:{x:{a:b:c:3}}}',          '{"y":{"x":{"a":{"b":{"c":3}}}}}'],
  ['{y:{x:{a:b:2,c:3}}}',        '{"y":{"x":{"a":{"b":2},"c":3}}}'],
  ['{y:{x:{a:1,b:c:3}}}',        '{"y":{"x":{"a":1,"b":{"c":3}}}}'],
  ['{y:{x:{a:b:c:3,d:4}}}',      '{"y":{"x":{"a":{"b":{"c":3}},"d":4}}}'],
  ['{y:{x:{a:1,b:c:d:4}}}',      '{"y":{"x":{"a":1,"b":{"c":{"d":4}}}}}'],
  ['{y:{x:{a:b:2,c:d:4}}}',      '{"y":{"x":{"a":{"b":2},"c":{"d":4}}}}'],
  ['{y:{x:{a:b:c:3,d:e:f:6}}}',  '{"y":{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}}}'],

  ['y:{x:{a:b:2}}',            '{"y":{"x":{"a":{"b":2}}}}'],
  ['y:{x:{a:b:c:3}}',          '{"y":{"x":{"a":{"b":{"c":3}}}}}'],
  ['y:{x:{a:b:2,c:3}}',        '{"y":{"x":{"a":{"b":2},"c":3}}}'],
  ['y:{x:{a:1,b:c:3}}',        '{"y":{"x":{"a":1,"b":{"c":3}}}}'],
  ['y:{x:{a:b:c:3,d:4}}',      '{"y":{"x":{"a":{"b":{"c":3}},"d":4}}}'],
  ['y:{x:{a:1,b:c:d:4}}',      '{"y":{"x":{"a":1,"b":{"c":{"d":4}}}}}'],
  ['y:{x:{a:b:2,c:d:4}}',      '{"y":{"x":{"a":{"b":2},"c":{"d":4}}}}'],
  ['y:{x:{a:b:c:3,d:e:f:6}}',  '{"y":{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}}}'],

  
  ['{y:{x:{a:b:2}},z:0}',            '{"y":{"x":{"a":{"b":2}}},"z":0}'],
  ['{y:{x:{a:b:c:3}},z:0}',          '{"y":{"x":{"a":{"b":{"c":3}}}},"z":0}'],
  ['{y:{x:{a:b:2,c:3}},z:0}',        '{"y":{"x":{"a":{"b":2},"c":3}},"z":0}'],
  ['{y:{x:{a:1,b:c:3}},z:0}',        '{"y":{"x":{"a":1,"b":{"c":3}}},"z":0}'],
  ['{y:{x:{a:b:c:3,d:4}},z:0}',      '{"y":{"x":{"a":{"b":{"c":3}},"d":4}},"z":0}'],
  ['{y:{x:{a:1,b:c:d:4}},z:0}',      '{"y":{"x":{"a":1,"b":{"c":{"d":4}}}},"z":0}'],
  ['{y:{x:{a:b:2,c:d:4}},z:0}',      '{"y":{"x":{"a":{"b":2},"c":{"d":4}}},"z":0}'],
  ['{y:{x:{a:b:c:3,d:e:f:6}},z:0}',  '{"y":{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}},"z":0}'],

  ['y:{x:{a:b:2}},z:0',            '{"y":{"x":{"a":{"b":2}}},"z":0}'],
  ['y:{x:{a:b:c:3}},z:0',          '{"y":{"x":{"a":{"b":{"c":3}}}},"z":0}'],
  ['y:{x:{a:b:2,c:3}},z:0',        '{"y":{"x":{"a":{"b":2},"c":3}},"z":0}'],
  ['y:{x:{a:1,b:c:3}},z:0',        '{"y":{"x":{"a":1,"b":{"c":3}}},"z":0}'],
  ['y:{x:{a:b:c:3,d:4}},z:0',      '{"y":{"x":{"a":{"b":{"c":3}},"d":4}},"z":0}'],
  ['y:{x:{a:1,b:c:d:4}},z:0',      '{"y":{"x":{"a":1,"b":{"c":{"d":4}}}},"z":0}'],
  ['y:{x:{a:b:2,c:d:4}},z:0',      '{"y":{"x":{"a":{"b":2},"c":{"d":4}}},"z":0}'],
  ['y:{x:{a:b:c:3,d:e:f:6}},z:0',  '{"y":{"x":{"a":{"b":{"c":3}},"d":{"e":{"f":6}}}},"z":0}'],

  
  ['{y:{x:{a:b:2}},z:k:0}',                                '{"y":{"x":{"a":{"b":2}}},"z":{"k":0}}'],
  ['{y:{x:{a:b:2,c:d:e:5,f:g:7}},z:k:{m:n:0,r:11},s:22}',  '{"y":{"x":{"a":{"b":2},"c":{"d":{"e":5}},"f":{"g":7}}},"z":{"k":{"m":{"n":0},"r":11}},"s":22}'],

  ['y:{x:{a:b:2}},z:k:0',                                '{"y":{"x":{"a":{"b":2}}},"z":{"k":0}}'],
  ['y:{x:{a:b:2,c:d:e:5,f:g:7}},z:k:{m:n:0,r:11},s:22',  '{"y":{"x":{"a":{"b":2},"c":{"d":{"e":5}},"f":{"g":7}}},"z":{"k":{"m":{"n":0},"r":11}},"s":22}'],

  ['{a:1 b:2}', '{"a":1,"b":2}'],
  ['a:1 b:2', '{"a":1,"b":2}'],

  ['{a:1 b:2 c:3}', '{"a":1,"b":2,"c":3}'],
  ['a:1 b:2 c:3', '{"a":1,"b":2,"c":3}'],

  ['{a:b:2 c:3}', '{"a":{"b":2},"c":3}'],
  ['{a:b:2 `c`:3}', '{"a":{"b":2},"c":3}'],
  ['{a:b:2 99:3}', '{"99":3,"a":{"b":2}}'],
  ['{a:b:2 true:3}', '{"a":{"b":2},"true":3}'],

  ['a:b:2 c:3', '{"a":{"b":2},"c":3}'],
  ['a:b:2 `c`:3', '{"a":{"b":2},"c":3}'],
  ['a:b:2 99:3', '{"99":3,"a":{"b":2}}'],
  ['a:b:2 true:3', '{"a":{"b":2},"true":3}'],

  ['{a:{b:c:3} d:4}', '{"a":{"b":{"c":3}},"d":4}'],
  ['a:{b:c:3} d:4', '{"a":{"b":{"c":3}},"d":4}'],

  ['[a]',      '["a"]'],
  ['[a,b]',    '["a","b"]'],

  ['[a]',      '["a"]'],
  ['[a,[b]]',  '["a",["b"]]'],

  ['[a b]',     '["a","b"]'],
  ['[a [b]]',   '["a",["b"]]'],
  ['[a {b:2}]', '["a",{"b":2}]'],

  ['[a,b,]',     '["a","b"]'],
  ['{a:1,b:2,}', '{"a":1,"b":2}'],

  ['a,b',    '["a","b"]'],

  ['{}',    '{}'],
  ['[]',    '[]'],

  ['[,]',    '[null]'],
  ['[,1]',    '[null,1]'],
  ['[,,1]',    '[null,null,1]'],
  ['[2,]',    '[2]'],
  ['[2,,1]',    '[2,null,1]'],
]


let count = {pass:0,fail:0}

cases.forEach(c=>{
  let out = j(c[0])
  let ok = out === c[1]
  count[ok?'pass':'fail']++
  console.log(ok?'\x1b[0;32mPASS':'\x1b[1;31mFAIL',c[0],'->',out)
  if(!ok) {
    console.log(' '.repeat(7+c[0].length),'\x1b[1;34m',c[1])
  }
})

console.log('\x1b[0m', count)
